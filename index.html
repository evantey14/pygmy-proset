<style>
#m {
  width: 800px;
  margin: 0 auto;
  display: flex;
  flex-direction: row;
}
#s {
  width: 62.5%;
}
#t {
  width: 37.5%;
  border-left: 1px solid #d0d0d0;
}
.r {
  display: flex;
  flex-direction: row;
  justify-content: center;
}
.c {
  width: 100;
  height: 150;
  background-color: #F0F0F0;
  border-radius: 5px;
  margin: 25;
}
.d {
  background-color: #000;
}
.h {
  -moz-box-shadow: inset 0 8px 0 0 #F3F3F3, 0 8px 16px 0 #909090;
  -webkit-box-shadow: inset 0 8px 0 0 #f3f3f3, 0 8px 16px 0 #909090;
}
</style>

<div id="m">
  <div id="s">
    <div class="r">
      <canvas class="c" id="c0"></canvas>
      <canvas class="c" id="c1"></canvas>
    </div>
    <div class="r">
      <canvas class="c" id="c2"></canvas>
      <canvas class="c" id="c3"></canvas>
      <canvas class="c" id="c4"></canvas>
    </div>
    <div class="r">
      <canvas class="c" id="c5"></canvas>
      <canvas class="c" id="c6"></canvas>
    </div>
  </div>
  <div id="t"></div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
var p=null,c=null,s=null,socket=io();
socket.emit('init');
socket.on('p',function(o){
p=o.p;
c=o.c;
s=o.s;
redraw();
});
socket.on('u',function(o){
c=o.c;
s=o.s;
redraw();
});
function submit(c){
socket.emit('s',{p:p,m:c});
}

var u=['#cc0000','#f57900','#edd400','#73d216','#3465a4','#75507b'];
var x=[25,75,25,75,25,75];
var y=[37,37,75,75,113,113];
var d=null;
$('.c:not(.d)').click(function(e){
  var n=parseInt(e.target.id.charAt(1));
  var i=[]
  $('#c'+n).toggleClass('h');
  d[n]=!d[n];
  for(var a=0;a<7;a++) {
    if(d[a]) {
      i.push(a);
    }
  }
  submit(i);
});

function redraw(){
  for(var n=0;n<7;n++){
    var w=$('#c'+n).get(0);
    w.setAttribute('width','100');
    w.setAttribute('height','150');
    var v=w.getContext("2d");
    for(var b=0,z=c[n];b<7;b++,z>>=1){
      if(z==null){
        $(w).addClass('d');
        break;
      }
      if(z&1){
        v.beginPath();
        v.arc(x[b],y[b],10,0,2*Math.PI);
        v.fillStyle=u[b];
        v.fill();
      }
    }
  }
  d=[0,0,0,0,0,0,0];
  $('.c').removeClass('h');
}
</script>
